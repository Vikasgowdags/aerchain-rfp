generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model RFP {
  id                    Int        @id @default(autoincrement())
  title                 String
  description           String
  budget                Float?
  deliveryTimelineDays  Int?
  paymentTerms          String?
  warrantyMinYears      Int?
  createdAt             DateTime   @default(now())

  items                 RFPItem[]
  proposals             Proposal[]

  // --- AI fields ---
  summary     String?   // AI-generated summary
  keyPoints   String?   // Store JSON as string (SQLite safe)
}


model RFPItem {
  id        Int      @id @default(autoincrement())
  rfp       RFP      @relation(fields: [rfpId], references: [id])
  rfpId     Int
  itemType  String
  quantity  Int
  specsJson String?    // JSON stored as string
}

model Vendor {
  id         Int         @id @default(autoincrement())
  name       String
  email      String      @unique
  category   String?
  createdAt  DateTime    @default(now())
  proposals  Proposal[]
}

model Proposal {
  id            Int      @id @default(autoincrement())
  rfp           RFP      @relation(fields: [rfpId], references: [id])
  rfpId         Int

  vendor        Vendor   @relation(fields: [vendorId], references: [id])
  vendorId      Int

  rawEmailBody  String
  totalPrice    Float?
  deliveryDays  Int?
  paymentTerms  String?
  warrantyYears Int?

  itemsJson     String?      // storing JSON as string (valid for SQLite)

  // --- AI FIELDS ---
  aiScore       Float?
  aiAnalysis    String?      // detailed explanation generated by AI

  createdAt     DateTime @default(now())
}

